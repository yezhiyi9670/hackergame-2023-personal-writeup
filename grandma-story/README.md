## 6. 奶奶的睡前 flag 故事

> 包含 AI 辅助创作

（以下内容由 GPT 辅助编写，如有雷同纯属巧合）

晴空万里的假期终于拍了拍翅膀飞来了。对于一心想扔掉教材、砸掉闹钟、跃向世界的 L 同学来说，期待了整整三年的跨国旅游大业终于是时候启动了，还能巧妙地顺带着做个美满的老友记。

可是，哎哟喂，他刚踩上波光粼粼的金沙海滩，那他最疼爱的华为手机就跟着海风一起去约会了大海，连他的钱包也在这场未知探索之旅中神秘失踪。

「这个地方怎么连个华为手机都不卖。若是买个苹果手机，心疼的是它连个实体 SIM 卡槽都藏起来了，回国肯定成了个大摆设。不如来个**谷歌的『亲儿子』**？」L 同学踌躇满志地嘀咕道。

那时，像是上天的安排，「咱这儿正好有个**谷歌『亲儿子』** 的老手机，你拿去逍遥吧」。

L 同学满眼星光地接过，**连系统都没心思升级**，就开始疯狂安装那个久闻大名的 GPT 程序，甚至雀跃地在群里晒出一张跟 GPT 对话的精彩**截图**，一时间成为了群里的焦点人物。

<img src="./screenshot.png" width="55%" />

### 题目描述

> 附件：[图像](screenshot.png)

无。点击“打开/下载题目”会打开题面中的这张截图。

### 尝试与解决

> 关键词：关键词、漏洞利用、本世纪最弱智 bug

这题看起来似乎毫无头绪，除了这张图之外，再也没有别的信息，题面中也没有隐写什么白色文字。唯一的手段，似乎就是从这张截图中还原 flag 信息。这张截图是一张裁剪后的截图，flag 应当在截图的最下方，可是裁剪过的图怎么可能恢复呢？

然而，题面中给出了几个不寻常的关键词——**谷歌的『亲儿子』**、**连系统都没心思升级**、**截图**。这几个关键词给出了重要的信息：

- **连系统都没心思升级**意味着旧版系统有漏洞。
- **截图**意味着漏洞与截图有关，或许是这个漏洞导致裁剪后的截图能够恢复。
- **谷歌的『亲儿子』**，指的是 Pixel 手机。这个漏洞或许是 Pixel 手机的系统所独有。

这时就可以启动搜索引擎了。关键词：Pixel 截图裁剪 漏洞。很快就可以找到漏洞——Pixel 中的截图标注工具有问题，导致裁剪的截图可以部分还原。甚至有人做了一个在线工具，叫 [aCropalypse](https://acropalypse.app/)。不妨把截图交给这个工具看看。

![](./assets/acropalypse.png)

工具恰好还原出了图片的最下面部分。于是 flag 就来了。

<img src="./assets/acropslypse-pixel-7.png" width="55%" />

### Flag

```plain
flag{sh1nj11ru_k0k0r0_4nata_m4h0}
```

### 拓展阅读

裁剪的截图可以还原，是因为截图软件将裁剪后的图像二进制（通常比原图文件更小）直接覆盖到了原图文件内容上，却没有丢弃多出的未覆盖部分。因此，裁剪后的图片文件实际上包含原图裁剪区域外的部分信息。

这样的截图还原漏洞不约而同地出现在了 Android 原生截图编辑工具和 Windows 的内置截图工具中，持续数年，波及上亿设备，危害了大量网民的隐私安全。好在国内的社交平台通常会二次压缩图像，这会导致图片文件的多余部分被直接丢弃，从而避免了隐私泄露（但是如果发送“原图”就没用了）。目前，此漏洞已被修复。

Bilibili UP 主“差评硬件部”有[一期视频](https://www.bilibili.com/video/BV1nm4y187cY/)专门介绍这个漏洞。UP 主评价这个 bug 为本世纪最弱智 bug。

### 不可行的做法

#### 通过图像处理工具还原

图像处理工具读取图片内容，会直接丢弃图片中的多余数据，自然也就丢弃了包含 flag 的部分，因此无论怎么编辑也无法还原 flag 内容。

比如这样：

<img src="./assets/failed-expansion.png" />

#### 问 ChatGPT

或者试试复现对话内容，

<img src="./assets/failed-conversation-2.png" width="48%" /> <img src="./assets/failed-conversation-1.png" width="48%" />

寄
